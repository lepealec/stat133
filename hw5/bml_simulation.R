#################################################################################
#### BML Simulation Study

#### Put in this file the code to run the BML simulation study for a set of input parameters.
#### Save some of the output data into an R object and use save() to save it to disk for reference
#### when you write up your results.
#### The output can e.g. be how many steps the system took until it hit gridlock or
#### how many steps you observered before concluding that it is in a free flowing state.
library("ggplot2")

bml.data=function(r,c,p){
    Unclear=c() ; Looping=c() ; Gridlock=c() ; counter=1
    while (counter<=100){
      result=bml.sim(r,c,p)
      if (result[[1]]=="U") {
        Unclear[length(Unclear)+1]=result[[2]] ; }
      if (result[[1]]=="L"){
        Looping[length(Looping)+1]=result[[2]] ; }
      if (result[[1]]=="G"){
      	Gridlock[length(Gridlock)+1]=result[[2]] ; }
      counter=counter+1;}
     ; return (list(Unclear,Looping,Gridlock,length(Unclear),length(Looping),length(Gridlock)))}
#a[[4]]=length(Unclear)
#a[[5]]=length(Looping)
#a[[6]]=length(Gridlock)

file10.1=bml.data(10,10,0.1)
save(file10.1,file="10_10_0.1")
file10.15=bml.data(10,10,0.15)
save(file10.15,file="10_10_0.15")
file10.2=bml.data(10,10,0.2)
save(file10.2,file="10_10_0.2")
file10.25=bml.data(10,10,0.25)
save(file10.25,file="10_10_0.25")
file10.3=bml.data(10,10,0.3)
save(file10.3,file="10_10_0.3")
file10.35=bml.data(10,10,0.35)
save(file10.35,file="10_10_0.35")
file10.4=bml.data(10,10,0.4)
save(file10.4,file="10_10_0.4")
file10.45=bml.data(10,10,0.45)
save(file10.45,file="10_10_0.45")
file10.5=bml.data(10,10,0.5)
save(file10.5,file="10_10_0.5")
file10.55=bml.data(10,10,0.55)
save(file10.55,file="10_10_0.55")
file10.6=bml.data(10,10,0.6)
save(file10.6,file="10_10_0.6")
file10.65=bml.data(10,10,0.65)
save(file10.65,file="10_10_0.65")
file10.7=bml.data(10,10,0.7)
save(file10.7,file="10_10_0.7")
file10.75=bml.data(10,10,0.75)
save(file10.75,file="10_10_0.75")
file10.8=bml.data(10,10,0.8)
save(file10.8,file="10_10_0.8")
file10.85=bml.data(10,10,0.85)
save(file10.85,file="10_10_0.85")

file20.1=bml.data(20,20,0.1)
save(file20.1,file="20_20_0.1")
file20.15=bml.data(20,20,0.15)
save(file20.15,file="20_20_0.15")
file20.2=bml.data(20,20,0.2)
save(file20.2,file="20_20_0.2")
file20.25=bml.data(20,20,0.25)
save(file20.25,file="20_20_0.25")
file20.3=bml.data(20,20,0.3)
save(file20.3,file="20_20_0.3")
file20.35=bml.data(20,20,0.35)
save(file20.35,file="20_20_0.35")
file20.4=bml.data(20,20,0.4)
save(file20.4,file="20_20_0.4")
file20.45=bml.data(20,20,0.45)
save(file20.45,file="20_20_0.45")
file20.5=bml.data(20,20,0.5)
save(file20.5,file="20_20_0.5")
file20.55=bml.data(20,20,0.55)
save(file20.55,file="20_20_0.55")
file20.6=bml.data(20,20,0.6)
save(file20.6,file="20_20_0.6")
file20.65=bml.data(20,20,0.65)
save(file20.65,file="20_20_0.65")
file20.7=bml.data(20,20,0.7)
save(file20.7,file="20_20_0.7")
file20.75=bml.data(20,20,0.75)
save(file20.75,file="20_20_0.75")
file20.8=bml.data(20,20,0.8)
save(file20.8,file="20_20_0.8")
file20.85=bml.data(20,20,0.85)
save(file20.85,file="20_20_0.85")

file30.1=bml.data(30,30,0.1)
save(file30.1,file="30_30_0.1")
file30.15=bml.data(30,30,0.15)
save(file30.15,file="30_30_0.15")
file30.2=bml.data(30,30,0.2)
save(file30.2,file="30_30_0.2")
file30.25=bml.data(30,30,0.25)
save(file30.25,file="30_30_0.25")
file30.3=bml.data(30,30,0.3)
save(file30.3,file="30_30_0.3")
file30.35=bml.data(30,30,0.35)
save(file30.35,file="30_30_0.35")
file30.4=bml.data(30,30,0.4)
save(file30.4,file="30_30_0.4")
file30.45=bml.data(30,30,0.45)
save(file30.45,file="30_30_0.45")
file30.5=bml.data(30,30,0.5)
save(file30.5,file="30_30_0.5")
file30.55=bml.data(30,30,0.55)
save(file30.55,file="30_30_0.55")
file30.6=bml.data(30,30,0.6)
save(file30.6,file="30_30_0.6")
file30.65=bml.data(30,30,0.65)
save(file30.65,file="30_30_0.65")
file30.7=bml.data(30,30,0.7)
save(file30.7,file="30_30_0.7")
file30.75=bml.data(30,30,0.75)
save(file30.75,file="30_30_0.75")
file30.8=bml.data(30,30,0.8)
save(file30.8,file="30_30_0.8")
file30.85=bml.data(30,30,0.85)
save(file30.85,file="30_30_0.85")

file40.1=bml.data(40,40,0.1)
save(file40.1,file="40_40_0.1")
file40.15=bml.data(40,40,0.15)
save(file40.15,file="40_40_0.15")
file40.2=bml.data(40,40,0.2)
save(file40.2,file="40_40_0.2")
file40.25=bml.data(40,40,0.25)
save(file40.25,file="40_40_0.25")
file40.3=bml.data(40,40,0.3)
save(file40.3,file="40_40_0.3")
file40.35=bml.data(40,40,0.35)
save(file40.35,file="40_40_0.35")
file40.4=bml.data(40,40,0.4)
save(file40.4,file="40_40_0.4")
file40.45=bml.data(40,40,0.45)
save(file40.45,file="40_40_0.45")
file40.5=bml.data(40,40,0.5)
save(file40.5,file="40_40_0.5")
file40.55=bml.data(40,40,0.55)
save(file40.55,file="40_40_0.55")
file40.6=bml.data(40,40,0.6)
save(file40.6,file="40_40_0.6")
file40.65=bml.data(40,40,0.65)
save(file40.65,file="40_40_0.65")
file40.7=bml.data(40,40,0.7)
save(file40.7,file="40_40_0.7")
file40.75=bml.data(40,40,0.75)
save(file40.75,file="40_40_0.75")
file40.8=bml.data(40,40,0.8)
save(file40.8,file="40_40_0.8")
file40.85=bml.data(40,40,0.85)
save(file40.85,file="40_40_0.85")

file50.1=bml.data(50,50,0.1)
save(file50.1,file="50_50_0.1")
file50.15=bml.data(50,50,0.15)
save(file50.15,file="50_50_0.15")
file50.2=bml.data(50,50,0.2)
save(file50.2,file="50_50_0.2")
file50.25=bml.data(50,50,0.25)
save(file50.25,file="50_50_0.25")
file50.3=bml.data(50,50,0.3)
save(file50.3,file="50_50_0.3")
file50.35=bml.data(50,50,0.35)
save(file50.35,file="50_50_0.35")
file50.4=bml.data(50,50,0.4)
save(file50.4,file="50_50_0.4")
file50.45=bml.data(50,50,0.45)
save(file50.45,file="50_50_0.45")
file50.5=bml.data(50,50,0.5)
save(file50.5,file="50_50_0.5")
file50.55=bml.data(50,50,0.55)
save(file50.55,file="50_50_0.55")
file50.6=bml.data(50,50,0.6)
save(file50.6,file="50_50_0.6")
file50.65=bml.data(50,50,0.65)
save(file50.65,file="50_50_0.65")
file50.7=bml.data(50,50,0.7)
save(file50.7,file="50_50_0.7")
file50.75=bml.data(50,50,0.75)
save(file50.75,file="50_50_0.75")
file50.8=bml.data(50,50,0.8)
save(file50.8,file="50_50_0.8")
file50.85=bml.data(50,50,0.85)
save(file50.85,file="50_50_0.85")

density=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85)
length_unclear_10=c(file10.1[[4]],file10.15[[4]],file10.2[[4]],file10.25[[4]],file10.3[[4]],file10.35[[4]],file10.4[[4]],file10.45[[4]],file10.5[[4]],file10.55[[4]],file10.6[[4]],file10.65[[4]],file10.7[[4]],file10.75[[4]],file10.8[[4]],file10.85[[4]])
length_unclear_20=c(file20.1[[4]],file20.15[[4]],file20.2[[4]],file20.25[[4]],file20.3[[4]],file20.35[[4]],file20.4[[4]],file20.45[[4]],file20.5[[4]],file20.55[[4]],file20.6[[4]],file20.65[[4]],file20.7[[4]],file20.75[[4]],file20.8[[4]],file20.85[[4]])
length_unclear_30=c(file30.1[[4]],file30.15[[4]],file30.2[[4]],file30.25[[4]],file30.3[[4]],file30.35[[4]],file30.4[[4]],file30.45[[4]],file30.5[[4]],file30.55[[4]],file30.6[[4]],file30.65[[4]],file30.7[[4]],file30.75[[4]],file30.8[[4]],file30.85[[4]])
length_unclear_40=c(file40.1[[4]],file40.15[[4]],file40.2[[4]],file40.25[[4]],file40.3[[4]],file40.35[[4]],file40.4[[4]],file40.45[[4]],file40.5[[4]],file40.55[[4]],file40.6[[4]],file40.65[[4]],file40.7[[4]],file40.75[[4]],file40.8[[4]],file40.85[[4]])
length_unclear_50=c(file50.1[[4]],file50.15[[4]],file50.2[[4]],file50.25[[4]],file50.3[[4]],file50.35[[4]],file50.4[[4]],file50.45[[4]],file50.5[[4]],file50.55[[4]],file50.6[[4]],file50.65[[4]],file50.7[[4]],file50.75[[4]],file50.8[[4]],file50.85[[4]])

length_looping_10=c(file10.1[[5]],file10.15[[5]],file10.2[[5]],file10.25[[5]],file10.3[[5]],file10.35[[5]],file10.4[[5]],file10.45[[5]],file10.5[[5]],file10.55[[5]],file10.6[[5]],file10.65[[5]],file10.7[[5]],file10.75[[5]],file10.8[[5]],file10.85[[5]])
length_looping_20=c(file20.1[[5]],file20.15[[5]],file20.2[[5]],file20.25[[5]],file20.3[[5]],file20.35[[5]],file20.4[[5]],file20.45[[5]],file20.5[[5]],file20.55[[5]],file20.6[[5]],file20.65[[5]],file20.7[[5]],file20.75[[5]],file20.8[[5]],file20.85[[5]])
length_looping_30=c(file30.1[[5]],file30.15[[5]],file30.2[[5]],file30.25[[5]],file30.3[[5]],file30.35[[5]],file30.4[[5]],file30.45[[5]],file30.5[[5]],file30.55[[5]],file30.6[[5]],file30.65[[5]],file30.7[[5]],file30.75[[5]],file30.8[[5]],file30.85[[5]])
length_looping_40=c(file40.1[[5]],file40.15[[5]],file40.2[[5]],file40.25[[5]],file40.3[[5]],file40.35[[5]],file40.4[[5]],file40.45[[5]],file40.5[[5]],file40.55[[5]],file40.6[[5]],file40.65[[5]],file40.7[[5]],file40.75[[5]],file40.8[[5]],file40.85[[5]])
length_looping_50=c(file50.1[[5]],file50.15[[5]],file50.2[[5]],file50.25[[5]],file50.3[[5]],file50.35[[5]],file50.4[[5]],file50.45[[5]],file50.5[[5]],file50.55[[5]],file50.6[[5]],file50.65[[5]],file50.7[[5]],file50.75[[5]],file50.8[[5]],file50.85[[5]])

length_gridlock_10=c(file10.1[[5]],file10.15[[5]],file10.2[[5]],file10.25[[5]],file10.3[[5]],file10.35[[5]],file10.4[[5]],file10.45[[5]],file10.5[[5]],file10.55[[5]],file10.6[[5]],file10.65[[5]],file10.7[[5]],file10.75[[5]],file10.8[[5]],file10.85[[5]])
length_gridlock_20=c(file20.1[[5]],file20.15[[5]],file20.2[[5]],file20.25[[5]],file20.3[[5]],file20.35[[5]],file20.4[[5]],file20.45[[5]],file20.5[[5]],file20.55[[5]],file20.6[[5]],file20.65[[5]],file20.7[[5]],file20.75[[5]],file20.8[[5]],file20.85[[5]])
length_gridlock_30=c(file30.1[[5]],file30.15[[5]],file30.2[[5]],file30.25[[5]],file30.3[[5]],file30.35[[5]],file30.4[[5]],file30.45[[5]],file30.5[[5]],file30.55[[5]],file30.6[[5]],file30.65[[5]],file30.7[[5]],file30.75[[5]],file30.8[[5]],file30.85[[5]])
length_gridlock_40=c(file40.1[[5]],file40.15[[5]],file40.2[[5]],file40.25[[5]],file40.3[[5]],file40.35[[5]],file40.4[[5]],file40.45[[5]],file40.5[[5]],file40.55[[5]],file40.6[[5]],file40.65[[5]],file40.7[[5]],file40.75[[5]],file40.8[[5]],file40.85[[5]])
length_gridlock_50=c(file50.1[[5]],file50.15[[5]],file50.2[[5]],file50.25[[5]],file50.3[[5]],file50.35[[5]],file50.4[[5]],file50.45[[5]],file50.5[[5]],file50.55[[5]],file50.6[[5]],file50.65[[5]],file50.7[[5]],file50.75[[5]],file50.8[[5]],file50.85[[5]])


gplot1=ggplot()
gplot1=gplot1+geom_line(aes(x=density,y=length_unclear_10),size=3,color="Purple",lty=3)
gplot1=gplot1+geom_line(aes(x=density,y=length_unclear_20),size=3,color="Blue",lty=3)
gplot1=gplot1+geom_line(aes(x=density,y=length_unclear_30),size=3,color="Green",lty=3)
gplot1=gplot1+geom_line(aes(x=density,y=length_unclear_40),size=3,color="Yellow",lty=3)
gplot1=gplot1+geom_line(aes(x=density,y=length_unclear_50),size=3,color="Red",lty=3)
gplot1=gplot1+xlab("Density")+ylab("Total Unclears")+ggtitle("Total Unclears versus density")
gplot1
save(gplot1,file="gplot_unclear_density")

gplot2=ggplot()
gplot2=gplot2+geom_line(aes(x=density,y=length_looping_10),size=3,color="Purple",lty=1)
gplot2=gplot2+geom_line(aes(x=density,y=length_looping_20),size=3,color="Blue",lty=1)
gplot2=gplot2+geom_line(aes(x=density,y=length_looping_30),size=3,color="Green",lty=1)
gplot2=gplot2+geom_line(aes(x=density,y=length_looping_40),size=3,color="Yellow",lty=1)
gplot2=gplot2+geom_line(aes(x=density,y=length_looping_50),size=3,color="Red",lty=1)
gplot2=gplot2+xlab("Density")+ylab("Total Loopings")+ggtitle("Total loopings versus density")
gplot2
save(gplot2,file="gplot_loopings_density")

gplot3=ggplot()
gplot3=gplot3+geom_line(aes(x=density,y=length_gridlock_10),size=3,color="Purple",lty=2)
gplot3=gplot3+geom_line(aes(x=density,y=length_gridlock_20),size=3,color="Blue",lty=2)
gplot3=gplot3+geom_line(aes(x=density,y=length_gridlock_30),size=3,color="Green",lty=2)
gplot3=gplot3+geom_line(aes(x=density,y=length_gridlock_40),size=3,color="Yellow",lty=2)
gplot3=gplot3+geom_line(aes(x=density,y=length_gridlock_50),size=3,color="Red",lty=2)
gplot3=gplot3+xlab("Density")+ylab("Total Gridlocks")+ggtitle("Total gridlocks versus density")
gplot3
save(gplot3,file="gplot_gridlock_density")